$:.unshift File.join(File.dirname(__FILE__), "..", "lib")
require "small_eigen_collider"

# FIXME make a better way to log things
ruby_engine = defined?(RUBY_ENGINE) ? RUBY_ENGINE : "unknown_engine"
output_filename = [ruby_engine, RUBY_VERSION, RUBY_PATCHLEVEL, "output.txt"].join("_")

logger = SmallEigenCollider::Logger.new_using_filename(output_filename)
task_creator = SmallEigenCollider::TaskCreator.new

1000.times do

  # FIXME rather than using Object#inspect, I have to create a method whose output doesn't vary depending on object id
  # or ruby implementation

  logger.log_start
  task = task_creator.create_task

  logger.log_input_parameters(task)
  task.run
  task.log_result(logger)
  logger.log_end
end
logger.close
